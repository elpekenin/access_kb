\newcommand{\myname}{Pablo Martínez Bernal}
\newcommand{\mytitle}{Desarrollo de un teclado para el S.XXI, accesible y programable en C y MicroPython}

\documentclass[11pt]{report}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{fontawesome} %icons

% Unicode chars
\usepackage{pmboxdraw}

% Images
\usepackage{graphicx}
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}

% Links
\usepackage[hidelinks]{hyperref}
  \hypersetup{
    pdfauthor={\myname},
    pdftitle={\mytitle}
  }

% References
\usepackage{csquotes}
\usepackage[spanish,activeacute]{babel}
\usepackage[
    backend=biber,
    sorting=none,
    citestyle=numeric,
    bibstyle=science
]{biblatex}
  \addbibresource{references.bib}

% Avoid indenting each line
  \setlength{\parindent}{0pt}

% Custom colors
\usepackage[dvipsnames]{xcolor}
  \definecolor{white}{RGB}{255,255,255}
\usepackage[most]{tcolorbox}
  
% Blocks of code
\usepackage{listings}
  \definecolor{stringColor}{rgb}{0.16,0.00,1.00}
  \definecolor{fieldColor}{rgb}{0.16,0.00,1.00}
  \definecolor{annotationColor}{rgb}{0.39,0.39,0.39}
  \definecolor{keywordColor}{rgb}{0.50,0.00,0.33}
  \definecolor{commentColor}{rgb}{0.25,0.50,0.37}
  \definecolor{lineNumberColor}{rgb}{0.47,0.47,0.47}
  \lstdefinestyle{defaultStyle}{language=c,
    basicstyle=\ttfamily\small\linespread{.5},
    commentstyle=\color{commentColor}\itshape,
    keywordstyle=\color{keywordColor}\bfseries,
    stringstyle=\color{stringColor},
    numberstyle=\color{lineNumberColor}\ttfamily\small,
    breakatwhitespace=false,
    breaklines=true,
    keepspaces=true,
    numberbychapter=false,
    numbers=left,
    numbersep=10pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    keywords={set,ordered,var,binary,param,minimize,last,sum,first,subject,to,in},
    % frame=tb,
    frame=lines, %Así parece que las lineas cubren el codigo mejor
    framerule=1pt,
    rulesep=1pt,
    framexleftmargin=2em,
    captionpos=t,
    belowcaptionskip=1em,
    aboveskip=1.5em,
    backgroundcolor=\color{white}
  }
  \lstdefinestyle{cliStyle}{
    basicstyle=\ttfamily\small\color{white},
    backgroundcolor=\color{black},
    numbers=none,
    breakatwhitespace=false,
    breaklines=true,
    keepspaces=true,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    framerule=0pt,
    framexleftmargin=-0.3cm,
    frame=lr,
    framesep=8pt,
    inputencoding=utf8,
  }
  \lstset{style=cliStyle}
  \renewcommand{\lstlistingname}{Código}%

% Front page
\usepackage{tikzpagenodes}
\usepackage{ragged2e}
  \addto\captionsspanish{\renewcommand{\contentsname}{Índice}}

% Page format
\usepackage[margin=2cm, top=2cm, includefoot]{geometry}
  \addtolength{\topmargin}{-1cm}
\usepackage{fancyhdr}
  \renewcommand{\chaptermark}[1]{\markboth{#1}{}}
  \setlength{\headheight}{60pt}
  \pagestyle{fancy}
  \fancyhf{}
  \fancyfoot[C]{\thepage}
  \lhead{
    \hyperref[chapter:contents]{\includegraphics[height=20pt]{images/UPCT-header.png}}
    \ifnum\value{chapter}=0 {}
    \else {{\hfill \Large \thechapter\ \itshape $\vert$ \leftmark \hspace{5cm} \hfill}}
    \fi
} 
% \rhead{\includegraphics[height=35pt]{image.png}}
\renewcommand{\headrulewidth}{3pt}
\renewcommand{\headrule}{\hbox to\headwidth{\color{RoyalBlue}\leaders\hrule height \headrulewidth\hfill}}

% Chapter format
\usepackage{chngcntr}
  \counterwithout{figure}{chapter}
  \counterwithout{table}{chapter}
\usepackage{etoolbox}
\usepackage[Glenn]{fncychap}
  \addto\captionsspanish{\renewcommand{\chaptername}{Sección}}
\makeatletter
\patchcmd{\@makechapterhead}{\vspace*{50\p@}}{\vspace*{-20\p@}}{}{}
\patchcmd{\@makeschapterhead}{\vspace*{50\p@}}{\vspace*{-20\p@}}{}{}
\patchcmd{\DOTI}{\vskip 80\p@}{\vskip 40\p@}{}{}
\patchcmd{\DOTIS}{\vskip 40\p@}{\vskip 0\p@}{}{}
\makeatother

% -- Custom functions
% Like break for CLI blocks
\newcommand{\mybreak}{\newline\hspace*{.5cm}}

% CLI
\newcommand{\cliarrow}{\textcolor{red}{\ttfamily\bfseries > }}

\DeclareTotalTCBox{\cli}{ v }
  {verbatim,colupper=white,colback=black!75!white,colframe=black}
  {\cliarrow \lstinline[language=command.com,keywordstyle=\color{blue!35!white}\bfseries]^#1^}

\newtcolorbox{multicli}{colupper=white, colback=black!75!white}
\newcommand{\mytab}{\hphantom{0.2cm}}

% Inline code
% \usepackage{tikz}
% \DeclareRobustCommand{\icode}[1]{%
%   \raisebox{-.2cm}{
%     \begin{tikzpicture}
%       \node[rectangle, rounded corners, fill=black!30]{#1};
%     \end{tikzpicture}
%   }%
% }


\newcommand{\icode}[1]{\tcbox[on line,top=-2pt,bottom=-2pt, left=-3pt, right=-3pt,colupper=black,colback=lightgray, colframe=lightgray]{#1}}
% \newtcolorbox{icodebox}{colback=red!5!white,colframe=red!75!black}

% Code block
\newcommand{\code}[2]{%file, caption
  \lstset{style=defaultStyle}
  \lstinputlisting[caption={#2}, captionpos=b]{snippets/#1}
  \lstset{style=cliStyle}
}

% Crediting on the right
\newcommand{\credit}[1]{%
  \begin{flushright}
    \item #1
  \end{flushright}
}

% Image
\newcommand{\image}[3]{%name, width, caption
  \begin{figure}[H]
    \centering
    \includegraphics[width=#2]{images/#1}
    \caption{#3}
  \end{figure}
}

% File
\newcommand{\lined}[1]{\smash{\begin{tabular}{l} \hline #1 \\ \hline \end{tabular}\hspace*{-\tabcolsep}}}

\newcommand{\file}[3]{%location, name, caption
  \vspace{-1cm}
  \begin{tcolorbox}[enhanced, breakable, boxrule=0pt, frame hidden]
    \faCode \ \texttt{#1/#2}
    \vspace{-.5cm}
    \code{#2}{#3}
  \end{tcolorbox}
}

\newcommand{\mycite}[1]{\textbf{\textcite{#1}}}